<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Song Management - Moodify Admin</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/admin.css') }}">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="admin-container">
        <aside class="admin-sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i class="fas fa-music"></i>
                    <h2>Moodify Admin</h2>
                </div>
            </div>
            <nav>
                <ul>
                    <li><a href="{{ url_for('logout') }}" class="nav-link logout">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>Logout</span>
                    </a></li>
                </ul>
            </nav>
        </aside>
        
        <main class="admin-content">
            <div class="content-header">
                <div class="header-left">
                    <h1>Song Management</h1>
                    <p>Manage your music library and organize songs by emotions</p>
                </div>
                <div class="header-right">
                    <div class="search-container">
                        <i class="fas fa-search"></i>
                        <input type="text" id="song-search" placeholder="Search songs, artists, or emotions...">
                    </div>
                </div>
            </div>
            
            <div class="management-controls">
                <div class="filter-controls">
                    <select id="emotion-filter">
                        <option value="">All Emotions</option>
                        <option value="Angry">Angry</option>
                        <option value="Disgust">Disgust</option>
                        <option value="Fear">Fear</option>
                        <option value="Happy">Happy</option>
                        <option value="Neutral">Neutral</option>
                        <option value="Sad">Sad</option>
                        <option value="Surprise">Surprise</option>
                        <option value="Pregnant">Pregnant</option>
                        <option value="Depression">Depression</option>
                        <option value="Trouble Sleeping">Trouble Sleeping</option>
                        <option value="Travelling">Travelling</option>
                        <option value="Stressed">Stressed</option>
                        <option value="Lonely">Lonely</option>
                        <option value="Excited">Excited</option>
                    </select>
                    
                    <select id="language-filter">
                        <option value="">All Languages</option>
                        <option value="English">English</option>
                        <option value="Sinhala">Sinhala</option>
                        <option value="Hindi">Hindi</option>
                        <option value="Tamil">Tamil</option>
                        <option value="Korean">Korean</option>
                        <option value="Other">Other</option>
                    </select>
                    
                    <button id="bulk-delete" class="btn-danger" style="display: none;">
                        <i class="fas fa-trash"></i> Delete Selected
                    </button>
                </div>
                
                <div class="view-controls">
                    <button id="grid-view" class="view-btn active">
                        <i class="fas fa-th"></i>
                    </button>
                    <button id="list-view" class="view-btn">
                        <i class="fas fa-list"></i>
                    </button>
                </div>
            </div>
            
            <div class="song-management">
                <!-- Add New Song Form -->
                <div class="add-song-form">
                    <div class="form-header">
                        <h3><i class="fas fa-plus-circle"></i> Add New Song</h3>
                        <button id="toggle-form" class="toggle-btn">
                            <i class="fas fa-chevron-up"></i>
                        </button>
                    </div>
                    
                    <div class="form-content">
                        <form id="add-song-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="emotion">
                                        <i class="fas fa-heart"></i> Emotion
                                    </label>
                                    <select id="emotion" name="emotion" required>
                                        <option value="">Select Emotion</option>
                                        <option value="Angry">üò† Angry</option>
                                        <option value="Disgust">ü§¢ Disgust</option>
                                        <option value="Fear">üò® Fear</option>
                                        <option value="Happy">üòä Happy</option>
                                        <option value="Neutral">üòê Neutral</option>
                                        <option value="Sad">üò¢ Sad</option>
                                        <option value="Surprise">üò≤ Surprise</option>
                                        <option value="Pregnant">ü§∞ Pregnant</option>
                                        <option value="Depression">üòû Depression</option>
                                        <option value="Trouble Sleeping">üò¥ Trouble Sleeping</option>
                                        <option value="Travelling">‚úàÔ∏è Travelling</option>
                                        <option value="Stressed">üò∞ Stressed</option>
                                        <option value="Lonely">üòî Lonely</option>
                                        <option value="Excited">ü§© Excited</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label for="language">
                                        <i class="fas fa-globe"></i> Language
                                    </label>
                                    <select id="language" name="language" required>
                                        <option value="">Select Language</option>
                                        <option value="English">üá∫üá∏ English</option>
                                        <option value="Sinhala">üá±üá∞ Sinhala</option>
                                        <option value="Hindi">üáÆüá≥ Hindi</option>
                                        <option value="Tamil">üáÆüá≥ Tamil</option>
                                        <option value="Korean">üá∞üá∑ Korean</option>
                                        <option value="Other">üåç Other</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="title">
                                    <i class="fas fa-music"></i> Song Title
                                </label>
                                <input type="text" id="title" name="title" placeholder="Enter song title" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="artist">
                                    <i class="fas fa-microphone"></i> Artist
                                </label>
                                <input type="text" id="artist" name="artist" placeholder="Enter artist name" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="url">
                                    <i class="fas fa-link"></i> URL (Spotify or YouTube)
                                </label>
                                <input type="url" id="url" name="url" placeholder="https://..." required>
                                <small>Paste the Spotify or YouTube link here</small>
                            </div>
                            
                            <button type="submit" class="btn-primary">
                                <i class="fas fa-plus"></i> Add Song
                            </button>
                        </form>
                    </div>
                </div>
                
                <!-- Songs Display -->
                <div class="songs-container">
                    <div class="songs-header">
                        <h3>
                            <i class="fas fa-music"></i> 
                            Music Library 
                            <span class="song-count">({{ songs_by_emotion.values() | sum(attribute='__len__') or 0 }} songs)</span>
                        </h3>
                    </div>
                    
                    <!-- Songs by Emotion -->
                    <div class="songs-by-emotion" id="songs-display">
                        {% for emotion, songs in songs_by_emotion.items() %}
                            {% if songs %}
                            <div class="emotion-section" data-emotion="{{ emotion }}">
                                <div class="emotion-header">
                                    <h3>
                                        <span class="emotion-icon">{{ emotion_icons.get(emotion, 'üéµ') }}</span>
                                        {{ emotion }}
                                        <span class="song-count">({{ songs|length }})</span>
                                    </h3>
                                    <button class="collapse-btn" data-target="{{ emotion }}">
                                        <i class="fas fa-chevron-down"></i>
                                    </button>
                                </div>
                                
                                <div class="song-grid" id="songs-{{ emotion }}">
                                    {% for song in songs %}
                                    <div class="song-card" data-song-id="{{ song.id }}" data-emotion="{{ emotion }}" data-language="{{ song.language }}">
                                        <div class="song-card-header">
                                            <input type="checkbox" class="song-select" value="{{ song.id }}">
                                            <div class="song-actions">
                                                <button class="action-btn edit-song" data-song-id="{{ song.id }}" title="Edit">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                                <button class="action-btn delete-song" data-song-id="{{ song.id }}" title="Delete">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </div>
                                        
                                        <div class="song-info">
                                            <div class="song-thumbnail">
                                                <i class="fas fa-music"></i>
                                            </div>
                                            
                                            <div class="song-details">
                                                <h4 class="song-title">{{ song.title }}</h4>
                                                <p class="song-artist">{{ song.artist }}</p>
                                                
                                                <div class="song-meta">
                                                    <span class="language-tag">{{ song.language }}</span>
                                                    <span class="emotion-tag">{{ emotion }}</span>
                                                </div>
                                                
                                                <div class="song-links">
                                                    <a href="{{ song.url }}" target="_blank" class="song-link">
                                                        {% if 'spotify' in song.url.lower() %}
                                                            <i class="fab fa-spotify"></i> Spotify
                                                        {% elif 'youtube' in song.url.lower() %}
                                                            <i class="fab fa-youtube"></i> YouTube
                                                        {% else %}
                                                            <i class="fas fa-external-link-alt"></i> Open
                                                        {% endif %}
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>
                            {% endif %}
                        {% endfor %}
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <!-- Edit Song Modal -->
    <div id="edit-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-edit"></i> Edit Song</h3>
                <button class="modal-close">&times;</button>
            </div>
            
            <form id="edit-song-form">
                <input type="hidden" id="edit-song-id">
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="edit-emotion">Emotion</label>
                        <select id="edit-emotion" name="emotion" required>
                            <option value="Angry">üò† Angry</option>
                            <option value="Disgust">ü§¢ Disgust</option>
                            <option value="Fear">üò® Fear</option>
                            <option value="Happy">üòä Happy</option>
                            <option value="Neutral">üòê Neutral</option>
                            <option value="Sad">üò¢ Sad</option>
                            <option value="Surprise">üò≤ Surprise</option>
                            <option value="Pregnant">ü§∞ Pregnant</option>
                            <option value="Depression">üòû Depression</option>
                            <option value="Trouble Sleeping">üò¥ Trouble Sleeping</option>
                            <option value="Travelling">‚úàÔ∏è Travelling</option>
                            <option value="Stressed">üò∞ Stressed</option>
                            <option value="Lonely">üòî Lonely</option>
                            <option value="Excited">ü§© Excited</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-language">Language</label>
                        <select id="edit-language" name="language" required>
                            <option value="English">üá∫üá∏ English</option>
                            <option value="Sinhala">üá±üá∞ Sinhala</option>
                            <option value="Hindi">üáÆüá≥ Hindi</option>
                            <option value="Tamil">üáÆüá≥ Tamil</option>
                            <option value="Korean">üá∞üá∑ Korean</option>
                            <option value="Other">üåç Other</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="edit-title">Song Title</label>
                    <input type="text" id="edit-title" name="title" required>
                </div>
                
                <div class="form-group">
                    <label for="edit-artist">Artist</label>
                    <input type="text" id="edit-artist" name="artist" required>
                </div>
                
                <div class="form-group">
                    <label for="edit-url">URL</label>
                    <input type="url" id="edit-url" name="url" required>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn-secondary modal-close">Cancel</button>
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Update Song
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <script src="{{ url_for('static', filename='js/admin.js') }}"></script>
</body>
</html>