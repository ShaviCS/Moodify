<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Moodify - Profile</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/profile.css') }}">
</head>
<body class="profile-page">
    <!-- Fixed navigation bar -->
    <header class="main-header">
        <div class="navbar">
            <div class="logo-nav">
                <a href="{{ url_for('welcome') }}">
                    <img src="{{ url_for('static', filename='images/LogoFypS-01.png') }}" alt="Moodify Logo" class="nav-logo">
                </a>
            </div>
            
            <nav class="main-nav">
                <ul class="nav-links">
                    <li><a href="{{ url_for('welcome') }}" class="nav-link">Home</a></li>
                    <li><a href="{{ url_for('welcome') }}#detect-section" class="nav-link">Detect Emotion</a></li>
                    <li><a href="{{ url_for('welcome') }}#upload-section" class="nav-link">Upload Image</a></li>
                    <li><a href="{{ url_for('welcome') }}#select-section" class="nav-link">Select Emotion</a></li>
                </ul>
            </nav>
            
            <!-- User profile in the navbar -->
            <div class="user-profile-nav">
                <div class="user-info" id="userInfo">
                    <span class="user-name">{{ session.get('name', 'User') }}</span>
                    <div class="user-avatar">
                        <img src="{{ url_for('static', filename='images/user-avatar.png') }}" alt="User Avatar">
                    </div>
                    <!-- Dropdown menu -->
                    <div class="user-dropdown" id="userDropdown">
                        <ul>
                            <li><a href="{{ url_for('profile') }}" class="active"><i class="fas fa-user"></i> Profile</a></li>
                            <li><a href="{{ url_for('settings') }}"><i class="fas fa-cog"></i> Settings</a></li>
                            <li class="dropdown-divider"></li>
                            <li><a href="{{ url_for('logout') }}" id="logoutBtn"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="profile-container">
        <div class="profile-header">
            <div class="breadcrumb">
                <a href="{{ url_for('welcome') }}">Home</a>
                <i class="fas fa-chevron-right"></i>
                <span>Profile</span>
            </div>
            <h1>My Profile</h1>
        </div>

        <div class="profile-content">
            <div class="profile-card">
                <div class="profile-avatar-section">
                    <div class="profile-avatar">
                        <img src="{{ url_for('static', filename='images/user-avatar.png') }}" alt="Profile Picture" id="profileImage">
                        <div class="avatar-overlay">
                            <i class="fas fa-camera"></i>
                        </div>
                    </div>
                    <input type="file" id="avatarUpload" accept="image/*" style="display: none;">
                    <button class="change-avatar-btn" id="changeAvatarBtn">
                        <i class="fas fa-camera"></i> Change Photo
                    </button>
                </div>

                <div class="profile-info-section">
                    <div class="info-group">
                        <label><i class="fas fa-user"></i> Full Name</label>
                        <div class="info-value">{{ user.name if user else session.get('name', 'User') }}</div>
                    </div>

                    <div class="info-group">
                        <label><i class="fas fa-envelope"></i> Email Address</label>
                        <div class="info-value">{{ user.email if user else session.get('email', 'user@example.com') }}</div>
                    </div>

                    <div class="info-group">
                        <label><i class="fas fa-calendar-alt"></i> Member Since</label>
                        <div class="info-value">{{ user.created_at.strftime('%B %d, %Y') if user and user.created_at else 'January 2025' }}</div>
                    </div>

                    <div class="info-group">
                        <label><i class="fas fa-language"></i> Preferred Languages</label>
                        <div class="languages-container">
                            {% if user and user.preferred_languages %}
                                {% for language in user.preferred_languages.split(',') %}
                                    <span class="language-tag">
                                        {% if language == 'English' %}üá∫üá∏{% endif %}
                                        {% if language == 'Sinhala' %}üá±üá∞{% endif %}
                                        {% if language == 'Tamil' %}üáÆüá≥{% endif %}
                                        {% if language == 'Korean' %}üá∞üá∑{% endif %}
                                        {% if language == 'Other' %}üåç{% endif %}
                                        {{ language }}
                                    </span>
                                {% endfor %}
                            {% else %}
                                <span class="language-tag">üá∫üá∏ English</span>
                            {% endif %}
                        </div>
                    </div>

                    <div class="info-group">
                        <label><i class="fas fa-chart-line"></i> Activity Stats</label>
                        <div class="stats-container">
                            <div class="stat-item">
                                <span class="stat-number">{{ user.emotion_detections_count if user else 0 }}</span>
                                <span class="stat-label">Emotions Detected</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">{{ user.songs_played_count if user else 0 }}</span>
                                <span class="stat-label">Songs Played</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">{{ user.total_sessions if user else 0 }}</span>
                                <span class="stat-label">Total Sessions</span>
                            </div>
                        </div>
                    </div>

                    <div class="profile-actions">
                        <a href="{{ url_for('settings') }}" class="edit-profile-btn">
                            <i class="fas fa-edit"></i> Edit Profile
                        </a>
                        <button class="secondary-btn" id="downloadDataBtn">
                            <i class="fas fa-download"></i> Download My Data
                        </button>
                    </div>
                </div>
            </div>

            <!-- Recent Activity Section -->
            <div class="activity-section">
                <h2>Recent Activity</h2>
                <div class="activity-list" id="activityList">
                    <div class="activity-item">
                        <div class="activity-icon">
                            <i class="fas fa-smile"></i>
                        </div>
                        <div class="activity-details">
                            <h4>Happy emotion detected</h4>
                            <p>Listened to "Good 4 U" by Olivia Rodrigo</p>
                            <span class="activity-time">2 hours ago</span>
                        </div>
                    </div>
                    
                    <div class="activity-item">
                        <div class="activity-icon">
                            <i class="fas fa-meh"></i>
                        </div>
                        <div class="activity-details">
                            <h4>Neutral emotion selected</h4>
                            <p>Explored ambient music playlist</p>
                            <span class="activity-time">Yesterday</span>
                        </div>
                    </div>
                    
                    <div class="activity-item">
                        <div class="activity-icon">
                            <i class="fas fa-sad-tear"></i>
                        </div>
                        <div class="activity-details">
                            <h4>Sad emotion detected</h4>
                            <p>Listened to "Someone Like You" by Adele</p>
                            <span class="activity-time">3 days ago</span>
                        </div>
                    </div>
                </div>
                
                <button class="load-more-btn" id="loadMoreActivity">
                    <i class="fas fa-chevron-down"></i> Load More Activity
                </button>
            </div>
        </div>
    </div>

    <footer class="main-footer">
        <p>¬© 2025 Moodify - Your Emotion-Based Music Recommender</p>
    </footer>

    <script src="{{ url_for('static', filename='js/profile.js') }}"></script>
</body>
</html>